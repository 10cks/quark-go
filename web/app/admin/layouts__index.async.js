"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[717],{52756:function(Ze,L,n){n.r(L);var N=n(97857),R=n.n(N),J=n(19632),E=n.n(J),Q=n(96695),I=n.n(Q),X=n(15009),P=n.n(X),Y=n(99289),b=n.n(Y),w=n(5574),v=n.n(w),f=n(67294),m=n(80854),q=n(94740),V=n(3321),ee=n(85418),ne=n(33852),Fe=n.n(ne),te=n(82925),_e=n(53032),ae=n(94785),h=n(22934),re=n(66949),A=n(43083),S=n(91373),se=n(87547),ue=n(11247),l=n(85893),oe=function(le){var j,ie=(0,m.useModel)("pageLoading"),de=ie.pageLoading,fe=(0,f.useState)({}),T=v()(fe,2),o=T[0],me=T[1],ve=(0,f.useState)({}),K=v()(ve,2),B=K[0],y=K[1],ce=(0,m.useModel)("pageLoading"),O=ce.setPageLoading,Ee=(0,m.useModel)("@@initialState"),C=Ee.initialState,d=C==null?void 0:C.accountInfo,p=(0,m.useLocation)(),c=ae.Z.parse(p.search),pe=(0,f.useState)(""),W=v()(pe,2),ge=W[0],z=W[1],Me=(0,f.useState)([]),k=v()(Me,2),Pe=k[0],D=k[1],he=(0,f.useState)([""]),Z=v()(he,2),F=Z[0],U=Z[1],Oe=(0,f.useState)(!1),x=v()(Oe,2),De=x[0],je=x[1],ye=(0,f.useState)([]),H=v()(ye,2),g=H[0],Ce=H[1],Ue=(0,f.useState)([]),$=v()(Ue,2),Le=$[0],Re=$[1],Ie=function(){var a=b()(P()().mark(function _(){var e,t,r,i;return P()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,m.request)("./config.json");case 2:if(e=s.sent,t=e.api.layout,t){s.next=7;break}return y("The layout API cannot be null!"),s.abrupt("return");case 7:return O(!0),s.next=10,(0,S.U)({url:t});case 10:r=s.sent,me(r),r.menu&&(Ce(We(r.menu)),Re(ze((0,ue.Z)(r.menu)))),i=(0,A.Ah)(r.menu,p.pathname,decodeURIComponent(M)),z(i),O(!1);case 16:case"end":return s.stop()}},_)}));return function(){return a.apply(this,arguments)}}(),be=function(){var a=b()(P()().mark(function _(){var e,t,r;return P()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(e=(0,A.Ah)(o.menu,p.pathname,decodeURIComponent(M)),z(e),M){u.next=5;break}return y(null),u.abrupt("return");case 5:return t={},Object.keys(c).forEach(function(s){s!=="api"&&(t[s]=c[s])}),O(!0),u.next=10,(0,S.U)({url:M,data:t});case 10:r=u.sent,y(r),O(!1);case 13:case"end":return u.stop()}},_)}));return function(){return a.apply(this,arguments)}}(),M="";c!=null&&c.api&&(M=c.api),(0,f.useEffect)(function(){Ie()},[]),(0,f.useEffect)(function(){be()},[c.api]);var Ae=function a(_){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o.menu,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],r=I()(e),i;try{for(r.s();!(i=r.n()).done;){var u=i.value,s=u.key;if(_===s)return D(E()(new Set(t))),t.push(s),U(E()(new Set(t))),u;if(u.routes&&u.routes.length>0){t.push(s);var G=a(_,u.routes,t);if(G)return D(E()(new Set(t))),U(E()(new Set(t))),G;t.pop()}}}catch(ke){r.e(ke)}finally{r.f()}},Se=function a(_){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];if(_.type===2)return _;if(!(!_.routes||!_.routes.length)){var t=I()(_.routes),r;try{for(t.s();!(r=t.n()).done;){var i=r.value;if(i.type===2)return i;if(i.routes&&i.routes.length>0){e.push(i.key);var u=a(i.routes[0]);if(u)return D(e),u;e.pop()}}}catch(s){t.e(s)}finally{t.f()}}},Te=function(_){var e=g.find(function(r){return r.key===_.key});if(e&&e.type!==3){if(e.type===1&&e.routes&&e.routes.length){var t=Se(e);if(!t)return;U(E()(new Set([].concat(E()(F),[t.key])))),m.history.push(t.path)}else if(e.type===2){if(e.is_link===1)return window.open(e.path,"_blank"),!1;m.history.push(e.path)}}},Ke=function(_){D(_)},Be=o==null||(j=o.rightMenus)===null||j===void 0?void 0:j.map(function(a,_){return{key:_,label:(0,l.jsx)(h.Z,{body:a})}});(0,f.useEffect)(function(){if(g&&g.length>0){var a=g.find(function(_){return _.path===p.pathname+p.search});if(!a)return;Ae(a.key)}},[p,g]);var We=function a(_){return _.reduce(function(e,t){return e.push(t),t.routes&&t.routes.length>0&&(e=e.concat(a(t.routes))),e},[])},ze=function a(_){return _.filter(function(e){return e.routes&&e.routes.length&&(e.routes=a(e.routes)),e.show})};return(0,l.jsx)(q.ZP,{locale:te.Z,children:(0,l.jsxs)(V.Z,{children:[(0,l.jsxs)(m.Helmet,{children:[(0,l.jsx)("meta",{charSet:"utf-8"}),(0,l.jsx)("title",{children:ge})]}),(o==null?void 0:o.title)&&(0,l.jsx)(_e.f,R()(R()({},o),{},{loading:de,logo:o.logo?o.logo:re,iconfontUrl:o.iconfontUrl,openKeys:Pe,selectedKeys:F,menuProps:{onOpenChange:Ke,onClick:Te},onCollapse:function(_){je(_)},menuDataRender:function(){return Le},actionsRender:function(){return[(0,l.jsx)(h.Z,{body:o.actions},"action")]},avatarProps:{src:d!=null&&d.avatar?d==null?void 0:d.avatar:(0,l.jsx)(se.Z,{}),size:"small",title:le.layout==="side"?De||d==null?void 0:d.nickname:d==null?void 0:d.nickname,render:function(_,e){return(0,l.jsx)(ee.Z,{menu:{items:Be},children:e})}},footerRender:function(){return(0,l.jsx)(h.Z,{body:o.footer})},children:B?(0,l.jsx)(h.Z,{body:B}):(0,l.jsx)(m.Outlet,{})}))]})})};L.default=oe}}]);
